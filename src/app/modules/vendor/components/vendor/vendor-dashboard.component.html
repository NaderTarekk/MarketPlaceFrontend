<div class="vendor-dashboard">
    <!-- Hero -->
    <section class="hero">
        <div class="hero-bg"></div>
        <div class="hero-content">
            <h1>
                <i class="fa-solid fa-store"></i>
                {{ i18n.currentLang === 'ar' ? 'لوحة تحكم التاجر' : 'Vendor Dashboard' }}
            </h1>
            <p>{{ i18n.currentLang === 'ar' ? 'إدارة منتجاتك ومتابعة مبيعاتك' : 'Manage your products and track your sales' }}</p>
        </div>
    </section>

    <div class="main-container">
        <!-- Tabs -->
        <div class="tabs-nav">
            <button class="tab-btn" [class.active]="activeTab === 'overview'" (click)="activeTab = 'overview'">
                <i class="fa-solid fa-chart-pie"></i>
                <span>{{ i18n.currentLang === 'ar' ? 'نظرة عامة' : 'Overview' }}</span>
            </button>
            <button class="tab-btn" [class.active]="activeTab === 'products'" (click)="activeTab = 'products'">
                <i class="fa-solid fa-box"></i>
                <span>{{ i18n.currentLang === 'ar' ? 'المنتجات' : 'Products' }}</span>
                <span class="badge" *ngIf="dashboard">{{ dashboard.totalProducts }}</span>
            </button>
            <button class="tab-btn" [class.active]="activeTab === 'orders'" (click)="activeTab = 'orders'">
                <i class="fa-solid fa-shopping-bag"></i>
                <span>{{ i18n.currentLang === 'ar' ? 'الطلبات' : 'Orders' }}</span>
                <span class="badge" *ngIf="dashboard">{{ dashboard.totalOrders }}</span>
            </button>
            <button class="tab-btn" [class.active]="activeTab === 'reports'" (click)="activeTab = 'reports'">
                <i class="fa-solid fa-chart-line"></i>
                <span>{{ i18n.currentLang === 'ar' ? 'التقارير' : 'Reports' }}</span>
            </button>
        </div>

        <!-- Loading -->
        <div *ngIf="isLoadingDashboard" class="loading">
            <div class="spinner"></div>
            <p>{{ i18n.currentLang === 'ar' ? 'جاري التحميل...' : 'Loading...' }}</p>
        </div>

        <!-- ═══════════════════════════════════════════════ -->
        <!-- OVERVIEW TAB -->
        <!-- ═══════════════════════════════════════════════ -->
        <div *ngIf="!isLoadingDashboard && activeTab === 'overview'" class="tab-content">
            <!-- Stats Cards -->
            <div class="stats-grid">
                <!-- Revenue Card -->
                <div class="stat-card revenue">
                    <div class="stat-icon">
                        <i class="fa-solid fa-sack-dollar"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-label">{{ i18n.currentLang === 'ar' ? 'إجمالي الإيرادات' : 'Total Revenue'
                            }}</span>
                        <span class="stat-value">{{ formatPrice(dashboard?.totalRevenue || 0) }}</span>
                        <div class="stat-change" [class.positive]="getRevenueGrowth() >= 0"
                            [class.negative]="getRevenueGrowth() < 0">
                            <i class="fa-solid"
                                [ngClass]="getRevenueGrowth() >= 0 ? 'fa-arrow-up' : 'fa-arrow-down'"></i>
                            <span>{{ Math.abs(getRevenueGrowth()) }}%</span>
                            <span class="period">{{ i18n.currentLang === 'ar' ? 'هذا الشهر' : 'this month' }}</span>
                        </div>
                    </div>
                </div>

                <!-- Orders Card -->
                <div class="stat-card orders">
                    <div class="stat-icon">
                        <i class="fa-solid fa-shopping-cart"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-label">{{ i18n.currentLang === 'ar' ? 'إجمالي الطلبات' : 'Total Orders'
                            }}</span>
                        <span class="stat-value">{{ dashboard?.totalOrders || 0 }}</span>
                        <div class="stat-breakdown">
                            <span class="pending">{{ dashboard?.pendingOrders || 0 }} {{ i18n.currentLang === 'ar' ?
                                'قيد الانتظار' : 'pending' }}</span>
                        </div>
                    </div>
                </div>

                <!-- Products Card -->
                <div class="stat-card products">
                    <div class="stat-icon">
                        <i class="fa-solid fa-box"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-label">{{ i18n.currentLang === 'ar' ? 'المنتجات' : 'Products' }}</span>
                        <span class="stat-value">{{ dashboard?.totalProducts || 0 }}</span>
                        <div class="stat-breakdown">
                            <span class="active">{{ dashboard?.activeProducts || 0 }} {{ i18n.currentLang === 'ar' ?
                                'نشط' : 'active' }}</span>
                            <span class="pending" *ngIf="dashboard?.pendingProducts">{{ dashboard?.pendingProducts }} {{
                                i18n.currentLang === 'ar' ? 'قيد المراجعة' : 'pending' }}</span>
                        </div>
                    </div>
                </div>

                <!-- Rating Card -->
                <div class="stat-card rating">
                    <div class="stat-icon">
                        <i class="fa-solid fa-star"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-label">{{ i18n.currentLang === 'ar' ? 'التقييم' : 'Rating' }}</span>
                        <span class="stat-value">{{ dashboard?.averageRating || 0 }}</span>
                        <div class="stat-breakdown">
                            <span>{{ dashboard?.totalReviews || 0 }} {{ i18n.currentLang === 'ar' ? 'تقييم' : 'reviews'
                                }}</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Stats Row -->
            <div class="quick-stats">
                <div class="quick-stat">
                    <i class="fa-solid fa-eye"></i>
                    <div class="quick-info">
                        <span class="quick-value">{{ dashboard?.totalViews || 0 }}</span>
                        <span class="quick-label">{{ i18n.currentLang === 'ar' ? 'مشاهدة' : 'Views' }}</span>
                    </div>
                </div>
                <div class="quick-stat">
                    <i class="fa-solid fa-check-circle"></i>
                    <div class="quick-info">
                        <span class="quick-value">{{ dashboard?.completedOrders || 0 }}</span>
                        <span class="quick-label">{{ i18n.currentLang === 'ar' ? 'طلب مكتمل' : 'Completed' }}</span>
                    </div>
                </div>
                <div class="quick-stat warning" *ngIf="dashboard?.outOfStockProducts">
                    <i class="fa-solid fa-exclamation-triangle"></i>
                    <div class="quick-info">
                        <span class="quick-value">{{ dashboard?.outOfStockProducts }}</span>
                        <span class="quick-label">{{ i18n.currentLang === 'ar' ? 'نفذ المخزون' : 'Out of Stock'
                            }}</span>
                    </div>
                </div>
                <div class="quick-stat danger" *ngIf="dashboard?.rejectedProducts">
                    <i class="fa-solid fa-times-circle"></i>
                    <div class="quick-info">
                        <span class="quick-value">{{ dashboard?.rejectedProducts }}</span>
                        <span class="quick-label">{{ i18n.currentLang === 'ar' ? 'مرفوض' : 'Rejected' }}</span>
                    </div>
                </div>
            </div>

            <!-- Content Grid -->
            <div class="content-grid">
                <!-- Recent Orders -->
                <div class="content-card">
                    <div class="card-header">
                        <h3>
                            <i class="fa-solid fa-clock"></i>
                            {{ i18n.currentLang === 'ar' ? 'آخر الطلبات' : 'Recent Orders' }}
                        </h3>
                        <button class="view-all" (click)="activeTab = 'orders'">
                            {{ i18n.currentLang === 'ar' ? 'عرض الكل' : 'View All' }}
                            <i class="fa-solid fa-arrow-left"></i>
                        </button>
                    </div>
                    <div class="card-body">
                        <div *ngIf="dashboard?.recentOrders?.length === 0" class="empty-state small">
                            <i class="fa-solid fa-inbox"></i>
                            <p>{{ i18n.currentLang === 'ar' ? 'لا توجد طلبات بعد' : 'No orders yet' }}</p>
                        </div>
                        <div *ngIf="dashboard && dashboard.recentOrders && dashboard.recentOrders.length > 0"
                            class="orders-list">
                            <div *ngFor="let order of dashboard!.recentOrders!.slice(0, 5)" class="order-item">
                                <div class="order-info">
                                    <span class="order-number">#{{ order.orderNumber }}</span>
                                    <span class="order-customer">{{ order.customerName }}</span>
                                </div>
                                <div class="order-details">
                                    <span class="order-amount">{{ formatPrice(order.totalAmount) }}</span>
                                    <span class="order-status" [ngClass]="getOrderStatusBadge(order.status).class">
                                        {{ getOrderStatusBadge(order.status).text }}
                                    </span>
                                </div>
                                <span class="order-date">{{ formatDate(order.createdAt) }}</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Top Selling Products -->
                <div class="content-card">
                    <div class="card-header">
                        <h3>
                            <i class="fa-solid fa-fire"></i>
                            {{ i18n.currentLang === 'ar' ? 'الأكثر مبيعاً' : 'Top Selling' }}
                        </h3>
                    </div>
                    <div class="card-body">
                        <div *ngIf="dashboard?.topSellingProducts?.length === 0" class="empty-state small">
                            <i class="fa-solid fa-chart-bar"></i>
                            <p>{{ i18n.currentLang === 'ar' ? 'لا توجد مبيعات بعد' : 'No sales yet' }}</p>
                        </div>
                        <div class="products-mini-list" *ngIf="dashboard?.topSellingProducts?.length">
                            <div *ngFor="let product of dashboard!.topSellingProducts" class="product-mini">
                                <img [src]="getImageUrl(product.mainImage)" [alt]="getName(product)" />
                                <div class="product-mini-info">
                                    <span class="product-mini-name">{{ getName(product) }}</span>
                                    <span class="product-mini-price">{{ formatPrice(product.price) }}</span>
                                </div>
                                <div class="product-mini-stats">
                                    <i class="fa-solid fa-star"></i>
                                    <span>{{ product.rating }}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Low Stock Alert -->
                <div class="content-card alert-card" *ngIf="dashboard?.lowStockProducts?.length">
                    <div class="card-header">
                        <h3>
                            <i class="fa-solid fa-exclamation-triangle"></i>
                            {{ i18n.currentLang === 'ar' ? 'تنبيه المخزون' : 'Low Stock Alert' }}
                        </h3>
                    </div>
                    <div class="card-body">
                        <div class="products-mini-list">
                            <div *ngFor="let product of dashboard!.lowStockProducts" class="product-mini warning">
                                <img [src]="getImageUrl(product.mainImage)" [alt]="getName(product)" />
                                <div class="product-mini-info">
                                    <span class="product-mini-name">{{ getName(product) }}</span>
                                    <span class="product-mini-stock">
                                        {{ i18n.currentLang === 'ar' ? 'متبقي' : 'Only' }} {{ product.stock }} {{
                                        i18n.currentLang === 'ar' ? 'فقط' : 'left' }}
                                    </span>
                                </div>
                                <button class="btn-mini" (click)="openEditProductDialog(product)">
                                    <i class="fa-solid fa-edit"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════ -->
        <!-- PRODUCTS TAB -->
        <!-- ═══════════════════════════════════════════════ -->
        <div *ngIf="activeTab === 'products'" class="tab-content">
            <!-- Products Header -->
            <div class="section-header">
                <div class="header-left">
                    <h2>
                        <i class="fa-solid fa-box"></i>
                        {{ i18n.currentLang === 'ar' ? 'منتجاتي' : 'My Products' }}
                        <span class="count">({{ totalCount }})</span>
                    </h2>
                </div>
                <button class="btn-add" (click)="openAddProductDialog()">
                    <i class="fa-solid fa-plus"></i>
                    <span>{{ i18n.currentLang === 'ar' ? 'إضافة منتج' : 'Add Product' }}</span>
                </button>
            </div>

            <!-- Filters -->
            <div class="filters-bar">
                <div class="search-box">
                    <i class="fa-solid fa-search"></i>
                    <input type="text" [value]="filter.search || ''" (input)="onSearch($event)"
                        [placeholder]="i18n.currentLang === 'ar' ? 'بحث في المنتجات...' : 'Search products...'" />
                </div>
                <div class="filter-tabs">
                    <button *ngFor="let opt of statusOptions" class="filter-tab"
                        [class.active]="statusFilter === opt.value" (click)="onStatusFilterChange(opt.value)">
                        {{ i18n.currentLang === 'ar' ? opt.label.ar : opt.label.en }}
                    </button>
                </div>
            </div>

            <!-- Loading -->
            <div *ngIf="isLoadingProducts" class="loading small">
                <div class="spinner"></div>
            </div>

            <!-- Empty -->
            <div *ngIf="!isLoadingProducts && products.length === 0" class="empty-state">
                <i class="fa-solid fa-box-open"></i>
                <h3>{{ i18n.currentLang === 'ar' ? 'لا توجد منتجات' : 'No products found' }}</h3>
                <p>{{ i18n.currentLang === 'ar' ? 'أضف منتجك الأول الآن' : 'Add your first product now' }}</p>
                <button class="btn-primary" (click)="openAddProductDialog()">
                    <i class="fa-solid fa-plus"></i>
                    {{ i18n.currentLang === 'ar' ? 'إضافة منتج' : 'Add Product' }}
                </button>
            </div>

            <!-- Products Grid -->
            <div *ngIf="!isLoadingProducts && products.length > 0" class="products-grid">
                <div *ngFor="let product of products; trackBy: trackByProduct" class="product-card">
                    <!-- Status Badge -->
                    <span class="status-badge" [ngClass]="getStatusBadge(product.status).class">
                        {{ getStatusBadge(product.status).text }}
                    </span>

                    <!-- Image -->
                    <div class="product-image">
                        <img [src]="getImageUrl(product.mainImage)" [alt]="getName(product)" />
                        <div class="product-overlay">
                            <button class="overlay-btn" (click)="openEditProductDialog(product)">
                                <i class="fa-solid fa-edit"></i>
                            </button>
                            <button class="overlay-btn delete" (click)="openDeleteDialog(product)">
                                <i class="fa-solid fa-trash"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Info -->
                    <div class="product-info">
                        <h3 class="product-name">{{ getName(product) }}</h3>
                        <div class="product-meta">
                            <span class="product-price">{{ formatPrice(product.price) }}</span>
                            <span class="product-stock" [class.low]="product.stock <= 5"
                                [class.out]="product.stock === 0">
                                <i class="fa-solid fa-box"></i>
                                {{ product.stock }}
                            </span>
                        </div>
                        <div class="product-stats">
                            <span class="stat">
                                <i class="fa-solid fa-star"></i>
                                {{ product.rating }}
                            </span>
                            <span class="stat">
                                <i class="fa-solid fa-comment"></i>
                                {{ product.reviewCount }}
                            </span>
                        </div>
                    </div>

                    <!-- Actions -->
                    <div class="product-actions">
                        <button class="btn-edit" (click)="openEditProductDialog(product)">
                            <i class="fa-solid fa-edit"></i>
                            {{ i18n.currentLang === 'ar' ? 'تعديل' : 'Edit' }}
                        </button>
                        <button class="btn-delete" (click)="openDeleteDialog(product)">
                            <i class="fa-solid fa-trash"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Pagination -->
            <div *ngIf="!isLoadingProducts && products.length > 0 && totalPages > 1" class="pagination">
                <button class="page-btn" (click)="prevPage()" [disabled]="!hasPrev">
                    <i class="fa-solid fa-chevron-right"></i>
                </button>
                <div class="page-numbers">
                    <button *ngFor="let page of getPageNumbers()" class="page-num" [class.active]="page === currentPage"
                        (click)="goToPage(page)">
                        {{ page }}
                    </button>
                </div>
                <button class="page-btn" (click)="nextPage()" [disabled]="!hasNext">
                    <i class="fa-solid fa-chevron-left"></i>
                </button>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════ -->
        <!-- ORDERS TAB -->
        <!-- ═══════════════════════════════════════════════ -->
        <div *ngIf="activeTab === 'orders'" class="tab-content">
            <div class="section-header">
                <h2>
                    <i class="fa-solid fa-shopping-bag"></i>
                    {{ i18n.currentLang === 'ar' ? 'طلباتي' : 'My Orders' }}
                </h2>
            </div>

            <div *ngIf="dashboard?.recentOrders?.length === 0" class="empty-state">
                <i class="fa-solid fa-inbox"></i>
                <h3>{{ i18n.currentLang === 'ar' ? 'لا توجد طلبات بعد' : 'No orders yet' }}</h3>
                <p>{{ i18n.currentLang === 'ar' ? 'ستظهر الطلبات هنا عندما يشتري العملاء منتجاتك' : 'Orders will appear here when customers buy your products' }}</p>
            </div>

            <div *ngIf="dashboard?.recentOrders?.length" class="orders-table-wrapper">
                <table class="orders-table">
                    <thead>
                        <tr>
                            <th>{{ i18n.currentLang === 'ar' ? 'رقم الطلب' : 'Order #' }}</th>
                            <th>{{ i18n.currentLang === 'ar' ? 'العميل' : 'Customer' }}</th>
                            <th>{{ i18n.currentLang === 'ar' ? 'المنتجات' : 'Products' }}</th>
                            <th>{{ i18n.currentLang === 'ar' ? 'المبلغ' : 'Amount' }}</th>
                            <th>{{ i18n.currentLang === 'ar' ? 'الحالة' : 'Status' }}</th>
                            <th>{{ i18n.currentLang === 'ar' ? 'التاريخ' : 'Date' }}</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let order of dashboard!.recentOrders">
                            <td class="order-number">#{{ order.orderNumber }}</td>
                            <td>{{ order.customerName }}</td>
                            <td>
                                <div class="order-items-preview">
                                    <img *ngFor="let item of order.items.slice(0, 3)"
                                        [src]="getImageUrl(item.productImage)" [alt]="item.productName"
                                        [title]="item.productName" />
                                    <span *ngIf="order.items.length > 3" class="more">+{{ order.items.length - 3
                                        }}</span>
                                </div>
                            </td>
                            <td class="order-amount">{{ formatPrice(order.totalAmount) }}</td>
                            <td>
                                <span class="status-badge" [ngClass]="getOrderStatusBadge(order.status).class">
                                    {{ getOrderStatusBadge(order.status).text }}
                                </span>
                            </td>
                            <td class="order-date">{{ formatDate(order.createdAt) }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════ -->
        <!-- REPORTS TAB -->
        <!-- ═══════════════════════════════════════════════ -->
        <div *ngIf="activeTab === 'reports'" class="tab-content">
            <div class="section-header">
                <h2>
                    <i class="fa-solid fa-chart-line"></i>
                    {{ i18n.currentLang === 'ar' ? 'تقرير المبيعات' : 'Sales Report' }}
                </h2>
                <div class="report-period">
                    <button [class.active]="reportPeriod === '7d'" (click)="onReportPeriodChange('7d')">7 {{
                        i18n.currentLang === 'ar' ? 'أيام' : 'Days' }}</button>
                    <button [class.active]="reportPeriod === '30d'" (click)="onReportPeriodChange('30d')">30 {{
                        i18n.currentLang === 'ar' ? 'يوم' : 'Days' }}</button>
                    <button [class.active]="reportPeriod === '90d'" (click)="onReportPeriodChange('90d')">90 {{
                        i18n.currentLang === 'ar' ? 'يوم' : 'Days' }}</button>
                </div>
            </div>

            <!-- Report Summary -->
            <div class="report-summary">
                <div class="report-stat">
                    <span class="report-label">{{ i18n.currentLang === 'ar' ? 'إجمالي الإيرادات' : 'Total Revenue'
                        }}</span>
                    <span class="report-value">{{ formatPrice(dashboard?.thisMonthRevenue || 0) }}</span>
                </div>
                <div class="report-stat">
                    <span class="report-label">{{ i18n.currentLang === 'ar' ? 'عدد الطلبات' : 'Orders Count' }}</span>
                    <span class="report-value">{{ getTotalOrders() }}</span>
                </div>
                <div class="report-stat">
                    <span class="report-label">{{ i18n.currentLang === 'ar' ? 'منتجات مباعة' : 'Products Sold' }}</span>
                    <span class="report-value">{{ getTotalProductsSold() }}</span>
                </div>
            </div>

            <!-- Report Table -->
            <div *ngIf="salesReport.length > 0" class="report-table-wrapper">
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>{{ i18n.currentLang === 'ar' ? 'التاريخ' : 'Date' }}</th>
                            <th>{{ i18n.currentLang === 'ar' ? 'الطلبات' : 'Orders' }}</th>
                            <th>{{ i18n.currentLang === 'ar' ? 'المنتجات المباعة' : 'Products Sold' }}</th>
                            <th>{{ i18n.currentLang === 'ar' ? 'الإيرادات' : 'Revenue' }}</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let day of salesReport">
                            <td>{{ formatDate(day.date) }}</td>
                            <td>{{ day.ordersCount }}</td>
                            <td>{{ day.productsSold }}</td>
                            <td class="revenue">{{ formatPrice(day.revenue) }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div *ngIf="salesReport.length === 0" class="empty-state small">
                <i class="fa-solid fa-chart-bar"></i>
                <p>{{ i18n.currentLang === 'ar' ? 'لا توجد بيانات للفترة المحددة' : 'No data for selected period' }}</p>
            </div>
        </div>
    </div>
</div>

<!-- ═══════════════════════════════════════════════ -->
<!-- ADD/EDIT PRODUCT DIALOG -->
<!-- ═══════════════════════════════════════════════ -->
<div class="dialog-overlay" [class.show]="showProductDialog" (click)="closeProductDialog()">
    <div class="dialog dialog-lg" (click)="$event.stopPropagation()">
        <div class="dialog-header">
            <h2>
                {{ isEditMode
                ? (i18n.currentLang === 'ar' ? 'تعديل المنتج' : 'Edit Product')
                : (i18n.currentLang === 'ar' ? 'إضافة منتج جديد' : 'Add New Product')
                }}
            </h2>
            <button class="close-btn" (click)="closeProductDialog()">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>

        <div class="dialog-body">
            <div class="form-grid">
                <!-- الاسم بالعربية -->
                <div class="form-group">
                    <label>{{ i18n.currentLang === 'ar' ? 'الاسم بالعربية' : 'Arabic Name' }} *</label>
                    <input type="text" [(ngModel)]="productForm.nameAr" />
                </div>

                <!-- الاسم بالإنجليزية -->
                <div class="form-group">
                    <label>{{ i18n.currentLang === 'ar' ? 'الاسم بالإنجليزية' : 'English Name' }} *</label>
                    <input type="text" [(ngModel)]="productForm.nameEn" />
                </div>

                <!-- الوصف بالعربية -->
                <div class="form-group full-width">
                    <label>{{ i18n.currentLang === 'ar' ? 'الوصف بالعربية' : 'Arabic Description' }}</label>
                    <textarea [(ngModel)]="productForm.descriptionAr" rows="3"></textarea>
                </div>

                <!-- الوصف بالإنجليزية -->
                <div class="form-group full-width">
                    <label>{{ i18n.currentLang === 'ar' ? 'الوصف بالإنجليزية' : 'English Description' }}</label>
                    <textarea [(ngModel)]="productForm.descriptionEn" rows="3"></textarea>
                </div>

                <!-- التصنيف -->
                <div class="form-group">
                    <label>{{ i18n.currentLang === 'ar' ? 'التصنيف' : 'Category' }} *</label>
                    <select [(ngModel)]="productForm.categoryId">
                        <option [ngValue]="null">{{ i18n.currentLang === 'ar' ? '-- اختر --' : '-- Select --' }}
                        </option>
                        <option *ngFor="let cat of categories" [ngValue]="cat.id">{{ getName(cat) }}</option>
                    </select>
                </div>

                <!-- العلامة التجارية -->
                <div class="form-group">
                    <label>{{ i18n.currentLang === 'ar' ? 'العلامة التجارية' : 'Brand' }}</label>
                    <select [(ngModel)]="productForm.brandId">
                        <option [ngValue]="null">{{ i18n.currentLang === 'ar' ? '-- اختر --' : '-- Select --' }}
                        </option>
                        <option *ngFor="let brand of brands" [ngValue]="brand.id">{{ getName(brand) }}</option>
                    </select>
                </div>

                <!-- السعر -->
                <div class="form-group">
                    <label>{{ i18n.currentLang === 'ar' ? 'السعر' : 'Price' }} *</label>
                    <input type="number" [(ngModel)]="productForm.price" min="0" step="0.01" />
                </div>

                <!-- السعر الأصلي -->
                <div class="form-group">
                    <label>{{ i18n.currentLang === 'ar' ? 'السعر قبل الخصم' : 'Original Price' }}</label>
                    <input type="number" [(ngModel)]="productForm.originalPrice" min="0" step="0.01" />
                </div>

                <!-- سعر التكلفة -->
                <div class="form-group">
                    <label>{{ i18n.currentLang === 'ar' ? 'سعر التكلفة' : 'Cost Price' }}</label>
                    <input type="number" [(ngModel)]="productForm.costPrice" min="0" step="0.01" />
                </div>

                <!-- المخزون -->
                <div class="form-group">
                    <label>{{ i18n.currentLang === 'ar' ? 'المخزون' : 'Stock' }}</label>
                    <input type="number" [(ngModel)]="productForm.stock" min="0" />
                </div>

                <!-- الصورة الرئيسية -->
                <div class="form-group full-width">
                    <label>{{ i18n.currentLang === 'ar' ? 'الصورة الرئيسية' : 'Main Image' }}</label>
                    <div class="image-upload">
                        <input type="file" id="mainImageVendor" accept="image/*" (change)="onMainImageSelected($event)"
                            hidden />
                        <label for="mainImageVendor" class="upload-box" *ngIf="!mainImagePreview">
                            <i class="fa-solid fa-cloud-upload-alt"></i>
                            <span>{{ i18n.currentLang === 'ar' ? 'اختر صورة' : 'Choose Image' }}</span>
                        </label>
                        <div class="image-preview" *ngIf="mainImagePreview">
                            <img [src]="mainImagePreview" alt="Preview" />
                            <button class="remove-btn" (click)="removeMainImage()">
                                <i class="fa-solid fa-times"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- صور إضافية -->
                <div class="form-group full-width">
                    <label>{{ i18n.currentLang === 'ar' ? 'صور إضافية' : 'Additional Images' }}</label>
                    <div class="multi-upload">
                        <input type="file" id="imagesVendor" accept="image/*" multiple
                            (change)="onImagesSelected($event)" hidden />
                        <label for="imagesVendor" class="upload-box small">
                            <i class="fa-solid fa-plus"></i>
                        </label>
                        <div class="image-preview small" *ngFor="let img of imagesPreview; let i = index">
                            <img [src]="img" alt="Preview" />
                            <button class="remove-btn" (click)="removeImage(i)">
                                <i class="fa-solid fa-times"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Note -->
            <div class="form-note">
                <i class="fa-solid fa-info-circle"></i>
                {{ i18n.currentLang === 'ar'
                ? 'سيتم مراجعة المنتج من قبل الإدارة قبل نشره'
                : 'Product will be reviewed by admin before publishing'
                }}
            </div>
        </div>

        <div class="dialog-footer">
            <button class="btn-cancel" (click)="closeProductDialog()" [disabled]="isSubmitting">
                {{ i18n.currentLang === 'ar' ? 'إلغاء' : 'Cancel' }}
            </button>
            <button class="btn-submit" (click)="saveProduct()" [disabled]="isSubmitting">
                <i *ngIf="isSubmitting" class="fa-solid fa-spinner fa-spin"></i>
                <span *ngIf="!isSubmitting">
                    {{ isEditMode
                    ? (i18n.currentLang === 'ar' ? 'حفظ' : 'Save')
                    : (i18n.currentLang === 'ar' ? 'إضافة' : 'Add')
                    }}
                </span>
            </button>
        </div>
    </div>
</div>

<!-- ═══════════════════════════════════════════════ -->
<!-- DELETE DIALOG -->
<!-- ═══════════════════════════════════════════════ -->
<div class="dialog-overlay" [class.show]="showDeleteDialog" (click)="closeDeleteDialog()">
    <div class="dialog dialog-sm" (click)="$event.stopPropagation()">
        <div class="dialog-icon delete">
            <i class="fa-solid fa-trash"></i>
        </div>
        <h3>{{ i18n.currentLang === 'ar' ? 'حذف المنتج' : 'Delete Product' }}</h3>
        <p>
            {{ i18n.currentLang === 'ar' ? 'هل أنت متأكد من حذف' : 'Are you sure you want to delete' }}
            <strong>"{{ productToDelete ? getName(productToDelete) : '' }}"</strong>؟
        </p>
        <div class="dialog-actions">
            <button class="btn-cancel" (click)="closeDeleteDialog()" [disabled]="isDeleting">
                {{ i18n.currentLang === 'ar' ? 'إلغاء' : 'Cancel' }}
            </button>
            <button class="btn-delete" (click)="confirmDelete()" [disabled]="isDeleting">
                <i *ngIf="isDeleting" class="fa-solid fa-spinner fa-spin"></i>
                <span *ngIf="!isDeleting">{{ i18n.currentLang === 'ar' ? 'حذف' : 'Delete' }}</span>
            </button>
        </div>
    </div>
</div>

<!-- Toast -->
<div class="toast" [class.show]="toast.show" [class.success]="toast.type === 'success'"
    [class.error]="toast.type === 'error'">
    <i class="fa-solid" [ngClass]="toast.type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'"></i>
    <span>{{ toast.message }}</span>
</div>